# 保存节点的测试规则

# 创建presentable

### 调用方式: POST

### 接口地址:

```
https://api.freelog.com/v1/testNodes
```

### body传入参数说明：

| 参数 | 必选 | 类型及范围 | 说明 |
| :--- | :--- | :--- | :--- |
| nodeId | 必选 | int | 节点ID |
| testRuleText | 必选 | string | 测试规则文本,base64编码  |

### body示例

```js
{
  "nodeId": 80000000,
  "testRuleText":"ICsgbmV3X3ByZXNlbnRhdGlvbl9uYW1lXzEgPT4gIzp5dWxpYW5nL3JlYWRtZTIgKyBuZXdfcHJlc2VudGF0aW9uX25hbWVfMiA9PiAkOnl1bGlhbmcv5Y+R6KGMQkBeMC4yLjAgLSBuZXdfcHJlc2VudGF0aW9uX25hbWVfMSAmIG5ld19wcmVzZW50YXRpb25fbmFtZV8xIHRhZ3M9W3Jlc2V0XSAqICQ6eXVsaWFuZy/ljZXkuIDotYTmupBEID0+ICQ6eXVsaWFuZy/ljZXkuIDotYTmupBFQDAuMS4w"
}
```

### 返回说明：

| 返回值字段 | 字段类型 | 字段说明 |
| :--- | :--- | :--- |

| userId | int| 创建方案的用户ID |
| nodeId | int| 节点ID |
| ruleText|string|规则文本|
| testRules| object[]| 测试规则集合|
| ** id|string|规则ID|
| ** text|string|规则原文|
| ** matchedTestResourceIds|string[]|规则匹配到的测试资源ID|
| ** matchErrors|string[]|规则匹配时的错误信息|
| ** ruleInfo|object|规则具体信息|
| **** operation|string|操作类型,包含add,replace,online,offline,set|
| **** presentation|string|指定作用的测试资源名称|
| **** candidate | object | add资源时的候选目标对象信息 |
| ****** name | string | 候选发行或者mock名称 |
| ****** type | string | 候选目标类型,mock或release |
| **** tags | string[] | add资源或者set时,设置的标签 |
| **** replaced | object | replace时的被替代者信息  |
| ****** name | string | 被替代者名称 |
| ****** type | string | 被替代者类型 |
| ****** versionRange | string | 被替代者版本范围 |
| **** replacer | object | replace时的替代者信息  |
| ****** name | string | 替代者名称 |
| ****** type | string | 替代者类型 |
| ****** versionRange | string | 替代者版本范围 |
| **** scope | object [] | 替换操作时的作用范围 |
| createDate| date|创建日期|


### 返回示例

```js
{
    "ret": 0,
    "errcode": 0,
    "msg": "success",
    "data": {
        "status": 0,
        "nodeId": 80000000,
        "userId": 50003,
        "ruleText": "ICsgbmV3X3ByZXNlbnRhdGlvbl9uYW1lXzEgPT4gIzp5dWxpYW5nL3JlYWRtZTIgKyBuZXdfcHJlc2VudGF0aW9uX25hbWVfMiA9PiAkOnl1bGlhbmcv5Y+R6KGMQkBeMC4yLjAgLSBuZXdfcHJlc2VudGF0aW9uX25hbWVfMSAmIG5ld19wcmVzZW50YXRpb25fbmFtZV8xIHRhZ3M9W3Jlc2V0XSAqICQ6eXVsaWFuZy/ljZXkuIDotYTmupBEID0+ICQ6eXVsaWFuZy/ljZXkuIDotYTmupBFQDAuMS4w",
        "testRules": [
            {
                "matchedTestResourceIds": [],
                "matchErrors": [],
                "id": "60fc0200dece4c06ad6fce8fc25d4c82",
                "text": "+ new_presentation_name_1 => #:yuliang/readme2",
                "ruleInfo": {
                    "operation": "add",
                    "presentation": "new_presentation_name_1",
                    "candidate": {
                        "name": "yuliang/readme2",
                        "type": "mock"
                    },
                    "tags": null
                }
            },
            {
                "matchedTestResourceIds": [],
                "matchErrors": [],
                "id": "2a9406d741f647fe9744e2d4c7de3e0d",
                "text": "+ new_presentation_name_2 => $:yuliang/发行B@^0.2.0",
                "ruleInfo": {
                    "operation": "add",
                    "presentation": "new_presentation_name_2",
                    "candidate": {
                        "name": "yuliang/发行B",
                        "versionRange": "^0.2.0",
                        "type": "release"
                    },
                    "tags": null
                }
            },
            {
                "matchedTestResourceIds": [],
                "matchErrors": [],
                "id": "99e154e9631f428d91fb7c411e751139",
                "text": "- new_presentation_name_1",
                "ruleInfo": {
                    "operation": "offline",
                    "presentation": "new_presentation_name_1"
                }
            },
            {
                "matchedTestResourceIds": [],
                "matchErrors": [],
                "id": "ddf1c9ee482848f1ad1c3a81b3565d0d",
                "text": "& new_presentation_name_1 tags=[reset]",
                "ruleInfo": {
                    "operation": "set",
                    "presentation": "new_presentation_name_1",
                    "tags": [
                        "reset"
                    ]
                }
            },
            {
                "matchedTestResourceIds": [],
                "matchErrors": [],
                "id": "fe5166ed7e8943e8aa4f601d3970780e",
                "text": "* $:yuliang/单一资源D => $:yuliang/单一资源E@0.1.0",
                "ruleInfo": {
                    "operation": "replace",
                    "replaced": {
                        "name": "yuliang/单一资源D",
                        "versionRange": "all",
                        "type": "release"
                    },
                    "replacer": {
                        "name": "yuliang/单一资源E",
                        "versionRange": "0.1.0",
                        "type": "release"
                    },
                    "scope": []
                }
            }
        ],
        "createDate": "2019-09-12T03:27:51.780Z",
        "updateDate": "2019-09-16T06:00:24.893Z",
    }
}
```